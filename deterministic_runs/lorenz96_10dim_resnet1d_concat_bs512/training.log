2025-12-09 18:21:55,245 - __main__ - INFO - ================================================================================
2025-12-09 18:21:55,245 - __main__ - INFO - Training Deterministic Next-Step Prediction Model
2025-12-09 18:21:55,245 - __main__ - INFO - ================================================================================
2025-12-09 18:21:55,245 - __main__ - INFO - Data directory: datasets/lorenz96_n4096_len100_dt0p0100_obs0p100_freq1_comp10of10_arctan
2025-12-09 18:21:55,245 - __main__ - INFO - Output directory: deterministic_runs/lorenz96_10dim_resnet1d_concat_bs512
2025-12-09 18:21:55,245 - __main__ - INFO - State dimension: 10
2025-12-09 18:21:55,245 - __main__ - INFO - Observation dimension: 10
2025-12-09 18:21:55,245 - __main__ - INFO - Use observations: True
2025-12-09 18:21:55,245 - __main__ - INFO - Architecture: ResNet1D (Deterministic)
2025-12-09 18:21:55,245 - __main__ - INFO -   Channels: 64
2025-12-09 18:21:55,245 - __main__ - INFO -   Num blocks: 10
2025-12-09 18:21:55,245 - __main__ - INFO -   Kernel size: 5
2025-12-09 18:21:55,245 - __main__ - INFO - Conditioning method: concat
2025-12-09 18:21:55,245 - __main__ - INFO - Batch size: 512
2025-12-09 18:21:55,245 - __main__ - INFO - Learning rate: 0.001
2025-12-09 18:21:55,245 - __main__ - INFO - Max epochs: 500
2025-12-09 18:21:55,245 - __main__ - INFO - GPUs: 1
2025-12-09 18:21:55,257 - __main__ - INFO - 
Model architecture:
2025-12-09 18:21:55,257 - __main__ - INFO -   Total parameters: 411,713
2025-12-09 18:21:55,257 - __main__ - INFO -   Trainable parameters: 411,713
2025-12-09 18:21:57,384 - __main__ - INFO - 
Starting training...
2025-12-09 18:21:57,921 - root - INFO - Loaded RF training data: 324324 pairs
2025-12-09 18:21:57,922 - root - INFO - Loaded RF validation data: 40491 pairs
2025-12-09 18:21:58,366 - root - INFO - Epoch 0: Val Loss = 1.054729, RMSE = 1.026866
2025-12-09 18:22:22,919 - root - INFO - Epoch 0: Val Loss = 0.000159, RMSE = 0.012559
2025-12-09 18:22:22,923 - root - INFO - Epoch 0: Train Loss = 0.022869, RMSE = 0.061163
2025-12-09 18:22:45,412 - root - INFO - Epoch 1: Val Loss = 0.000497, RMSE = 0.022271
2025-12-09 18:22:45,415 - root - INFO - Epoch 1: Train Loss = 0.000159, RMSE = 0.011134
2025-12-09 18:23:08,649 - root - INFO - Epoch 2: Val Loss = 0.000333, RMSE = 0.018183
2025-12-09 18:23:08,653 - root - INFO - Epoch 2: Train Loss = 0.000162, RMSE = 0.010770
2025-12-09 18:23:32,792 - root - INFO - Epoch 3: Val Loss = 0.000021, RMSE = 0.004569
2025-12-09 18:23:32,796 - root - INFO - Epoch 3: Train Loss = 0.000133, RMSE = 0.009626
2025-12-09 18:23:54,809 - root - INFO - Epoch 4: Val Loss = 0.000088, RMSE = 0.009347
2025-12-09 18:23:54,813 - root - INFO - Epoch 4: Train Loss = 0.000115, RMSE = 0.009308
2025-12-09 18:24:16,926 - root - INFO - Epoch 5: Val Loss = 0.000023, RMSE = 0.004783
2025-12-09 18:24:16,929 - root - INFO - Epoch 5: Train Loss = 0.000115, RMSE = 0.009659
2025-12-09 18:24:38,158 - root - INFO - Epoch 6: Val Loss = 0.000075, RMSE = 0.008675
2025-12-09 18:24:38,162 - root - INFO - Epoch 6: Train Loss = 0.000113, RMSE = 0.009182
2025-12-09 18:25:00,290 - root - INFO - Epoch 7: Val Loss = 0.000008, RMSE = 0.002810
2025-12-09 18:25:00,294 - root - INFO - Epoch 7: Train Loss = 0.000098, RMSE = 0.008263
2025-12-09 18:25:21,818 - root - INFO - Epoch 8: Val Loss = 0.000062, RMSE = 0.007852
2025-12-09 18:25:21,824 - root - INFO - Epoch 8: Train Loss = 0.000090, RMSE = 0.008155
2025-12-09 18:25:44,912 - root - INFO - Epoch 9: Val Loss = 0.000027, RMSE = 0.005157
2025-12-09 18:25:44,915 - root - INFO - Epoch 9: Train Loss = 0.000093, RMSE = 0.007974
2025-12-09 18:26:10,227 - root - INFO - Epoch 10: Val Loss = 0.000034, RMSE = 0.005857
2025-12-09 18:26:10,231 - root - INFO - Epoch 10: Train Loss = 0.000074, RMSE = 0.007370
2025-12-09 18:26:32,954 - root - INFO - Epoch 11: Val Loss = 0.000016, RMSE = 0.003964
2025-12-09 18:26:32,957 - root - INFO - Epoch 11: Train Loss = 0.000065, RMSE = 0.007047
2025-12-09 18:26:54,780 - root - INFO - Epoch 12: Val Loss = 0.000016, RMSE = 0.004004
2025-12-09 18:26:54,783 - root - INFO - Epoch 12: Train Loss = 0.000062, RMSE = 0.006918
2025-12-09 18:27:17,787 - root - INFO - Epoch 13: Val Loss = 0.000013, RMSE = 0.003652
2025-12-09 18:27:17,790 - root - INFO - Epoch 13: Train Loss = 0.000063, RMSE = 0.006988
2025-12-09 18:27:39,827 - root - INFO - Epoch 14: Val Loss = 0.000061, RMSE = 0.007801
2025-12-09 18:27:39,830 - root - INFO - Epoch 14: Train Loss = 0.000056, RMSE = 0.006397
2025-12-09 18:28:02,127 - root - INFO - Epoch 15: Val Loss = 0.000020, RMSE = 0.004396
2025-12-09 18:28:02,131 - root - INFO - Epoch 15: Train Loss = 0.000051, RMSE = 0.006540
2025-12-09 18:28:25,772 - root - INFO - Epoch 16: Val Loss = 0.000008, RMSE = 0.002793
2025-12-09 18:28:25,776 - root - INFO - Epoch 16: Train Loss = 0.000046, RMSE = 0.005717
2025-12-09 18:28:48,406 - root - INFO - Epoch 17: Val Loss = 0.000007, RMSE = 0.002578
2025-12-09 18:28:48,410 - root - INFO - Epoch 17: Train Loss = 0.000047, RMSE = 0.006048
2025-12-09 18:29:11,000 - root - INFO - Epoch 18: Val Loss = 0.000042, RMSE = 0.006469
2025-12-09 18:29:11,004 - root - INFO - Epoch 18: Train Loss = 0.000052, RMSE = 0.005735
2025-12-09 18:29:33,034 - root - INFO - Epoch 19: Val Loss = 0.000009, RMSE = 0.002936
2025-12-09 18:29:33,038 - root - INFO - Epoch 19: Train Loss = 0.000031, RMSE = 0.004908
2025-12-09 18:29:54,517 - root - INFO - Epoch 20: Val Loss = 0.000242, RMSE = 0.015512
2025-12-09 18:29:54,522 - root - INFO - Epoch 20: Train Loss = 0.000049, RMSE = 0.005817
2025-12-09 18:30:15,501 - root - INFO - Epoch 21: Val Loss = 0.000027, RMSE = 0.005203
2025-12-09 18:30:15,505 - root - INFO - Epoch 21: Train Loss = 0.000032, RMSE = 0.003903
2025-12-09 18:30:37,653 - root - INFO - Epoch 22: Val Loss = 0.000049, RMSE = 0.006995
2025-12-09 18:30:37,656 - root - INFO - Epoch 22: Train Loss = 0.000034, RMSE = 0.004936
2025-12-09 18:31:00,181 - root - INFO - Epoch 23: Val Loss = 0.000003, RMSE = 0.001687
2025-12-09 18:31:00,184 - root - INFO - Epoch 23: Train Loss = 0.000035, RMSE = 0.004806
2025-12-09 18:31:23,697 - root - INFO - Epoch 24: Val Loss = 0.000020, RMSE = 0.004500
2025-12-09 18:31:23,700 - root - INFO - Epoch 24: Train Loss = 0.000028, RMSE = 0.004732
2025-12-09 18:31:46,032 - root - INFO - Epoch 25: Val Loss = 0.000012, RMSE = 0.003401
2025-12-09 18:31:46,035 - root - INFO - Epoch 25: Train Loss = 0.000029, RMSE = 0.004436
2025-12-09 18:32:08,526 - root - INFO - Epoch 26: Val Loss = 0.000023, RMSE = 0.004795
2025-12-09 18:32:08,530 - root - INFO - Epoch 26: Train Loss = 0.000028, RMSE = 0.004867
2025-12-09 18:32:30,165 - root - INFO - Epoch 27: Val Loss = 0.000021, RMSE = 0.004590
2025-12-09 18:32:30,169 - root - INFO - Epoch 27: Train Loss = 0.000030, RMSE = 0.004491
2025-12-09 18:32:53,043 - root - INFO - Epoch 28: Val Loss = 0.000027, RMSE = 0.005136
2025-12-09 18:32:53,046 - root - INFO - Epoch 28: Train Loss = 0.000412, RMSE = 0.008831
2025-12-09 18:33:15,034 - root - INFO - Epoch 29: Val Loss = 0.000008, RMSE = 0.002785
2025-12-09 18:33:15,038 - root - INFO - Epoch 29: Train Loss = 0.000019, RMSE = 0.003942
2025-12-09 18:33:37,166 - root - INFO - Epoch 30: Val Loss = 0.000003, RMSE = 0.001716
2025-12-09 18:33:37,169 - root - INFO - Epoch 30: Train Loss = 0.000012, RMSE = 0.002957
2025-12-09 18:33:59,299 - root - INFO - Epoch 31: Val Loss = 0.000005, RMSE = 0.002292
2025-12-09 18:33:59,303 - root - INFO - Epoch 31: Train Loss = 0.000014, RMSE = 0.003055
2025-12-09 18:34:22,866 - root - INFO - Epoch 32: Val Loss = 0.000006, RMSE = 0.002410
2025-12-09 18:34:22,870 - root - INFO - Epoch 32: Train Loss = 0.000022, RMSE = 0.003685
2025-12-09 18:34:45,693 - root - INFO - Epoch 33: Val Loss = 0.000013, RMSE = 0.003572
2025-12-09 18:34:45,696 - root - INFO - Epoch 33: Train Loss = 0.000022, RMSE = 0.003967
2025-12-09 18:34:45,875 - __main__ - INFO - 
Training completed!
2025-12-09 18:34:45,875 - __main__ - INFO - Best model checkpoint: /home/cnagda/DataAssimilation/deterministic_runs/lorenz96_10dim_resnet1d_concat_bs512/checkpoints/det-epoch=023-val_loss=0.000003.ckpt
2025-12-09 18:34:45,876 - __main__ - INFO - Best validation loss: 0.000003
2025-12-09 18:34:45,908 - __main__ - INFO - Final model saved to: deterministic_runs/lorenz96_10dim_resnet1d_concat_bs512/final_model.ckpt
2025-12-09 18:34:45,913 - eval_deterministic - INFO - Running Deterministic Model Evaluation (Autoregressive)
2025-12-09 18:34:45,914 - eval_deterministic - INFO - Checkpoint: /home/cnagda/DataAssimilation/deterministic_runs/lorenz96_10dim_resnet1d_concat_bs512/checkpoints/det-epoch=023-val_loss=0.000003.ckpt
2025-12-09 18:34:45,976 - root - INFO - Updated system normalization stats from data.h5
2025-12-09 18:34:45,983 - eval_deterministic - INFO - Evaluating on 411 trajectories, length 99
2025-12-09 18:35:00,764 - eval_deterministic - INFO - Global Mean RMSE (Autoregressive): 3.4414
