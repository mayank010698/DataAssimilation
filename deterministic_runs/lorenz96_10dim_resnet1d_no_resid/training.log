2025-12-11 17:18:59,544 - __main__ - INFO - ================================================================================
2025-12-11 17:18:59,544 - __main__ - INFO - Training Deterministic Next-Step Prediction Model
2025-12-11 17:18:59,544 - __main__ - INFO - ================================================================================
2025-12-11 17:18:59,544 - __main__ - INFO - Data directory: datasets/lorenz96_n4096_len100_dt0p0100_obs0p100_freq1_comp10of10_arctan
2025-12-11 17:18:59,544 - __main__ - INFO - Output directory: deterministic_runs/lorenz96_10dim_resnet1d_no_resid
2025-12-11 17:18:59,544 - __main__ - INFO - State dimension: 10
2025-12-11 17:18:59,544 - __main__ - INFO - Observation dimension: 10
2025-12-11 17:18:59,544 - __main__ - INFO - Use observations: True
2025-12-11 17:18:59,544 - __main__ - INFO - Architecture: ResNet1D (Deterministic)
2025-12-11 17:18:59,544 - __main__ - INFO -   Channels: 64
2025-12-11 17:18:59,544 - __main__ - INFO -   Num blocks: 10
2025-12-11 17:18:59,544 - __main__ - INFO -   Kernel size: 5
2025-12-11 17:18:59,544 - __main__ - INFO - Conditioning method: concat
2025-12-11 17:18:59,544 - __main__ - INFO - Batch size: 256
2025-12-11 17:18:59,544 - __main__ - INFO - Learning rate: 0.0003
2025-12-11 17:18:59,544 - __main__ - INFO - Weight decay: 0.0001
2025-12-11 17:18:59,544 - __main__ - INFO - Scheduler patience: 10
2025-12-11 17:18:59,544 - __main__ - INFO - Output L2 regularization: 0.0001
2025-12-11 17:18:59,544 - __main__ - INFO - Predict residual: False
2025-12-11 17:18:59,544 - __main__ - INFO - Max epochs: 500
2025-12-11 17:18:59,544 - __main__ - INFO - GPUs: 1
2025-12-11 17:18:59,556 - __main__ - INFO - 
Model architecture:
2025-12-11 17:18:59,556 - __main__ - INFO -   Total parameters: 411,713
2025-12-11 17:18:59,556 - __main__ - INFO -   Trainable parameters: 411,713
2025-12-11 17:19:01,728 - __main__ - INFO - 
Starting training...
2025-12-11 17:19:02,208 - root - INFO - Loaded RF training data: 324324 pairs
2025-12-11 17:19:02,209 - root - INFO - Loaded RF validation data: 40491 pairs
2025-12-11 17:19:03,972 - root - INFO - Epoch 0: Val Loss = 1.068296, RMSE = 1.031696
2025-12-11 17:19:49,580 - root - INFO - Epoch 0: Val Loss = 0.000212, RMSE = 0.013202
2025-12-11 17:19:49,584 - root - INFO - Epoch 0: Train Loss = 0.024556, RMSE = 0.058731
2025-12-11 17:20:35,311 - root - INFO - Epoch 1: Val Loss = 0.000222, RMSE = 0.013502
2025-12-11 17:20:35,315 - root - INFO - Epoch 1: Train Loss = 0.000158, RMSE = 0.010055
2025-12-11 17:21:21,228 - root - INFO - Epoch 2: Val Loss = 0.000068, RMSE = 0.005917
2025-12-11 17:21:21,231 - root - INFO - Epoch 2: Train Loss = 0.000116, RMSE = 0.007870
2025-12-11 17:22:07,218 - root - INFO - Epoch 3: Val Loss = 0.000050, RMSE = 0.004364
2025-12-11 17:22:07,222 - root - INFO - Epoch 3: Train Loss = 0.000105, RMSE = 0.007438
2025-12-11 17:22:55,118 - root - INFO - Epoch 4: Val Loss = 0.000036, RMSE = 0.002749
2025-12-11 17:22:55,122 - root - INFO - Epoch 4: Train Loss = 0.000079, RMSE = 0.006316
2025-12-11 17:23:41,025 - root - INFO - Epoch 5: Val Loss = 0.000045, RMSE = 0.004414
2025-12-11 17:23:41,029 - root - INFO - Epoch 5: Train Loss = 0.000073, RMSE = 0.006177
2025-12-11 17:24:27,373 - root - INFO - Epoch 6: Val Loss = 0.000105, RMSE = 0.009085
2025-12-11 17:24:27,377 - root - INFO - Epoch 6: Train Loss = 0.000067, RMSE = 0.005811
2025-12-11 17:25:15,121 - root - INFO - Epoch 7: Val Loss = 0.000053, RMSE = 0.005701
2025-12-11 17:25:15,124 - root - INFO - Epoch 7: Train Loss = 0.000061, RMSE = 0.005435
2025-12-11 17:26:02,528 - root - INFO - Epoch 8: Val Loss = 0.000034, RMSE = 0.004096
2025-12-11 17:26:02,532 - root - INFO - Epoch 8: Train Loss = 0.000049, RMSE = 0.004702
2025-12-11 17:26:48,917 - root - INFO - Epoch 9: Val Loss = 0.000037, RMSE = 0.004633
2025-12-11 17:26:48,921 - root - INFO - Epoch 9: Train Loss = 0.000048, RMSE = 0.004847
2025-12-11 17:27:34,991 - root - INFO - Epoch 10: Val Loss = 0.000021, RMSE = 0.002788
2025-12-11 17:27:34,994 - root - INFO - Epoch 10: Train Loss = 0.000041, RMSE = 0.004752
2025-12-11 17:28:21,241 - root - INFO - Epoch 11: Val Loss = 0.000021, RMSE = 0.002986
2025-12-11 17:28:21,245 - root - INFO - Epoch 11: Train Loss = 0.000038, RMSE = 0.004669
2025-12-11 17:29:08,419 - root - INFO - Epoch 12: Val Loss = 0.000017, RMSE = 0.002537
2025-12-11 17:29:08,423 - root - INFO - Epoch 12: Train Loss = 0.000036, RMSE = 0.004500
2025-12-11 17:29:52,943 - root - INFO - Epoch 13: Val Loss = 0.000018, RMSE = 0.002802
2025-12-11 17:29:52,947 - root - INFO - Epoch 13: Train Loss = 0.000033, RMSE = 0.004252
2025-12-11 17:30:39,484 - root - INFO - Epoch 14: Val Loss = 0.000013, RMSE = 0.001923
2025-12-11 17:30:39,487 - root - INFO - Epoch 14: Train Loss = 0.000031, RMSE = 0.004167
2025-12-11 17:31:24,034 - root - INFO - Epoch 15: Val Loss = 0.000019, RMSE = 0.003286
2025-12-11 17:31:24,038 - root - INFO - Epoch 15: Train Loss = 0.000027, RMSE = 0.003923
2025-12-11 17:32:07,957 - root - INFO - Epoch 16: Val Loss = 0.000012, RMSE = 0.002030
2025-12-11 17:32:07,961 - root - INFO - Epoch 16: Train Loss = 0.000027, RMSE = 0.003766
2025-12-11 17:32:52,048 - root - INFO - Epoch 17: Val Loss = 0.000014, RMSE = 0.002544
2025-12-11 17:32:52,052 - root - INFO - Epoch 17: Train Loss = 0.000025, RMSE = 0.003817
2025-12-11 17:33:39,113 - root - INFO - Epoch 18: Val Loss = 0.000009, RMSE = 0.001499
2025-12-11 17:33:39,117 - root - INFO - Epoch 18: Train Loss = 0.000024, RMSE = 0.003733
2025-12-11 17:34:27,555 - root - INFO - Epoch 19: Val Loss = 0.000016, RMSE = 0.003044
2025-12-11 17:34:27,563 - root - INFO - Epoch 19: Train Loss = 0.000024, RMSE = 0.003739
2025-12-11 17:35:14,071 - root - INFO - Epoch 20: Val Loss = 0.000009, RMSE = 0.001605
2025-12-11 17:35:14,079 - root - INFO - Epoch 20: Train Loss = 0.000021, RMSE = 0.003474
2025-12-11 17:36:00,854 - root - INFO - Epoch 21: Val Loss = 0.000024, RMSE = 0.004180
2025-12-11 17:36:00,857 - root - INFO - Epoch 21: Train Loss = 0.000021, RMSE = 0.003507
2025-12-11 17:36:45,891 - root - INFO - Epoch 22: Val Loss = 0.000048, RMSE = 0.006467
2025-12-11 17:36:45,895 - root - INFO - Epoch 22: Train Loss = 0.000020, RMSE = 0.003461
2025-12-11 17:37:32,896 - root - INFO - Epoch 23: Val Loss = 0.000015, RMSE = 0.002913
2025-12-11 17:37:32,899 - root - INFO - Epoch 23: Train Loss = 0.000020, RMSE = 0.003387
2025-12-11 17:38:18,613 - root - INFO - Epoch 24: Val Loss = 0.000008, RMSE = 0.001478
2025-12-11 17:38:18,617 - root - INFO - Epoch 24: Train Loss = 0.000019, RMSE = 0.003332
2025-12-11 17:39:05,660 - root - INFO - Epoch 25: Val Loss = 0.000023, RMSE = 0.004145
2025-12-11 17:39:05,664 - root - INFO - Epoch 25: Train Loss = 0.000018, RMSE = 0.003155
2025-12-11 17:39:52,590 - root - INFO - Epoch 26: Val Loss = 0.000011, RMSE = 0.002378
2025-12-11 17:39:52,594 - root - INFO - Epoch 26: Train Loss = 0.000018, RMSE = 0.003197
2025-12-11 17:40:40,430 - root - INFO - Epoch 27: Val Loss = 0.000010, RMSE = 0.002082
2025-12-11 17:40:40,434 - root - INFO - Epoch 27: Train Loss = 0.000017, RMSE = 0.003096
2025-12-11 17:41:28,372 - root - INFO - Epoch 28: Val Loss = 0.000007, RMSE = 0.001387
2025-12-11 17:41:28,376 - root - INFO - Epoch 28: Train Loss = 0.000018, RMSE = 0.003167
2025-12-11 17:42:15,553 - root - INFO - Epoch 29: Val Loss = 0.000016, RMSE = 0.003320
2025-12-11 17:42:15,556 - root - INFO - Epoch 29: Train Loss = 0.000016, RMSE = 0.002855
2025-12-11 17:43:02,311 - root - INFO - Epoch 30: Val Loss = 0.000015, RMSE = 0.003138
2025-12-11 17:43:02,315 - root - INFO - Epoch 30: Train Loss = 0.000016, RMSE = 0.002878
2025-12-11 17:43:51,273 - root - INFO - Epoch 31: Val Loss = 0.000014, RMSE = 0.002965
2025-12-11 17:43:51,277 - root - INFO - Epoch 31: Train Loss = 0.000016, RMSE = 0.002863
2025-12-11 17:44:37,907 - root - INFO - Epoch 32: Val Loss = 0.000015, RMSE = 0.003160
2025-12-11 17:44:37,911 - root - INFO - Epoch 32: Train Loss = 0.000015, RMSE = 0.002822
2025-12-11 17:45:25,247 - root - INFO - Epoch 33: Val Loss = 0.000009, RMSE = 0.002153
2025-12-11 17:45:25,251 - root - INFO - Epoch 33: Train Loss = 0.000015, RMSE = 0.002881
2025-12-11 17:46:12,425 - root - INFO - Epoch 34: Val Loss = 0.000026, RMSE = 0.004576
2025-12-11 17:46:12,429 - root - INFO - Epoch 34: Train Loss = 0.000014, RMSE = 0.002743
2025-12-11 17:46:58,410 - root - INFO - Epoch 35: Val Loss = 0.000008, RMSE = 0.001861
2025-12-11 17:46:58,414 - root - INFO - Epoch 35: Train Loss = 0.000014, RMSE = 0.002773
2025-12-11 17:47:42,784 - root - INFO - Epoch 36: Val Loss = 0.000008, RMSE = 0.001742
2025-12-11 17:47:42,787 - root - INFO - Epoch 36: Train Loss = 0.000014, RMSE = 0.002790
2025-12-11 17:48:30,207 - root - INFO - Epoch 37: Val Loss = 0.000010, RMSE = 0.002308
2025-12-11 17:48:30,211 - root - INFO - Epoch 37: Train Loss = 0.000013, RMSE = 0.002637
2025-12-11 17:49:08,792 - root - INFO - Epoch 38: Val Loss = 0.000125, RMSE = 0.010974
2025-12-11 17:49:08,796 - root - INFO - Epoch 38: Train Loss = 0.000013, RMSE = 0.002714
2025-12-11 17:49:11,419 - __main__ - INFO - 
Training completed!
2025-12-11 17:49:11,420 - __main__ - INFO - Best model checkpoint: /home/cnagda/DataAssimilation/deterministic_runs/lorenz96_10dim_resnet1d_no_resid/checkpoints/det-epoch=028-val_loss=0.000007.ckpt
2025-12-11 17:49:11,421 - __main__ - INFO - Best validation loss: 0.000007
2025-12-11 17:49:11,452 - __main__ - INFO - Final model saved to: deterministic_runs/lorenz96_10dim_resnet1d_no_resid/final_model.ckpt
2025-12-11 17:49:11,458 - eval_deterministic - INFO - Running Deterministic Model Evaluation (Autoregressive)
2025-12-11 17:49:11,458 - eval_deterministic - INFO - Checkpoint: /home/cnagda/DataAssimilation/deterministic_runs/lorenz96_10dim_resnet1d_no_resid/checkpoints/det-epoch=028-val_loss=0.000007.ckpt
2025-12-11 17:49:11,523 - root - INFO - Updated system normalization stats from data.h5
2025-12-11 17:49:11,529 - eval_deterministic - INFO - Evaluating on 411 trajectories, length 99
2025-12-11 17:49:29,214 - eval_deterministic - INFO - Global Mean RMSE (Autoregressive): 0.2968
