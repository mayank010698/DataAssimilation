2025-12-10 21:02:02,020 - __main__ - INFO - ================================================================================
2025-12-10 21:02:02,020 - __main__ - INFO - Training Deterministic Next-Step Prediction Model
2025-12-10 21:02:02,020 - __main__ - INFO - ================================================================================
2025-12-10 21:02:02,020 - __main__ - INFO - Data directory: datasets/lorenz96_n4096_len100_dt0p0100_obs0p100_freq1_comp10of10_arctan
2025-12-10 21:02:02,020 - __main__ - INFO - Output directory: deterministic_runs/lorenz96_10dim_resnet1d_stable
2025-12-10 21:02:02,020 - __main__ - INFO - State dimension: 10
2025-12-10 21:02:02,020 - __main__ - INFO - Observation dimension: 10
2025-12-10 21:02:02,020 - __main__ - INFO - Use observations: True
2025-12-10 21:02:02,020 - __main__ - INFO - Architecture: ResNet1D (Deterministic)
2025-12-10 21:02:02,020 - __main__ - INFO -   Channels: 64
2025-12-10 21:02:02,020 - __main__ - INFO -   Num blocks: 10
2025-12-10 21:02:02,020 - __main__ - INFO -   Kernel size: 5
2025-12-10 21:02:02,020 - __main__ - INFO - Conditioning method: concat
2025-12-10 21:02:02,020 - __main__ - INFO - Batch size: 256
2025-12-10 21:02:02,020 - __main__ - INFO - Learning rate: 0.0003
2025-12-10 21:02:02,020 - __main__ - INFO - Weight decay: 0.0001
2025-12-10 21:02:02,020 - __main__ - INFO - Scheduler patience: 10
2025-12-10 21:02:02,020 - __main__ - INFO - Output L2 regularization: 0.0001
2025-12-10 21:02:02,020 - __main__ - INFO - Max epochs: 500
2025-12-10 21:02:02,020 - __main__ - INFO - GPUs: 1
2025-12-10 21:02:02,031 - __main__ - INFO - 
Model architecture:
2025-12-10 21:02:02,032 - __main__ - INFO -   Total parameters: 411,713
2025-12-10 21:02:02,032 - __main__ - INFO -   Trainable parameters: 411,713
2025-12-10 21:02:04,202 - __main__ - INFO - 
Starting training...
2025-12-10 21:02:04,678 - root - INFO - Loaded RF training data: 324324 pairs
2025-12-10 21:02:04,678 - root - INFO - Loaded RF validation data: 40491 pairs
2025-12-10 21:02:05,144 - root - INFO - Epoch 0: Val Loss = 0.011242, RMSE = 0.105628
2025-12-10 21:02:51,797 - root - INFO - Epoch 0: Val Loss = 0.000017, RMSE = 0.001338
2025-12-10 21:02:51,801 - root - INFO - Epoch 0: Train Loss = 0.000223, RMSE = 0.007035
2025-12-10 21:03:37,454 - root - INFO - Epoch 1: Val Loss = 0.000005, RMSE = 0.001102
2025-12-10 21:03:37,458 - root - INFO - Epoch 1: Train Loss = 0.000010, RMSE = 0.001265
2025-12-10 21:04:22,358 - root - INFO - Epoch 2: Val Loss = 0.000004, RMSE = 0.001418
2025-12-10 21:04:22,362 - root - INFO - Epoch 2: Train Loss = 0.000004, RMSE = 0.001088
2025-12-10 21:05:10,011 - root - INFO - Epoch 3: Val Loss = 0.000003, RMSE = 0.001232
2025-12-10 21:05:10,014 - root - INFO - Epoch 3: Train Loss = 0.000002, RMSE = 0.000959
2025-12-10 21:05:56,625 - root - INFO - Epoch 4: Val Loss = 0.000001, RMSE = 0.000622
2025-12-10 21:05:56,629 - root - INFO - Epoch 4: Train Loss = 0.000002, RMSE = 0.000879
2025-12-10 21:06:42,724 - root - INFO - Epoch 5: Val Loss = 0.000001, RMSE = 0.000662
2025-12-10 21:06:42,728 - root - INFO - Epoch 5: Train Loss = 0.000002, RMSE = 0.000873
2025-12-10 21:07:28,999 - root - INFO - Epoch 6: Val Loss = 0.000002, RMSE = 0.001179
2025-12-10 21:07:29,003 - root - INFO - Epoch 6: Train Loss = 0.000001, RMSE = 0.000791
2025-12-10 21:08:15,903 - root - INFO - Epoch 7: Val Loss = 0.000001, RMSE = 0.000764
2025-12-10 21:08:15,907 - root - INFO - Epoch 7: Train Loss = 0.000001, RMSE = 0.000783
2025-12-10 21:09:02,175 - root - INFO - Epoch 8: Val Loss = 0.000001, RMSE = 0.000578
2025-12-10 21:09:02,179 - root - INFO - Epoch 8: Train Loss = 0.000001, RMSE = 0.000736
2025-12-10 21:09:48,025 - root - INFO - Epoch 9: Val Loss = 0.000000, RMSE = 0.000481
2025-12-10 21:09:48,029 - root - INFO - Epoch 9: Train Loss = 0.000001, RMSE = 0.000746
2025-12-10 21:10:34,593 - root - INFO - Epoch 10: Val Loss = 0.000000, RMSE = 0.000542
2025-12-10 21:10:34,597 - root - INFO - Epoch 10: Train Loss = 0.000001, RMSE = 0.000695
2025-12-10 21:11:22,467 - root - INFO - Epoch 11: Val Loss = 0.000001, RMSE = 0.000654
2025-12-10 21:11:22,471 - root - INFO - Epoch 11: Train Loss = 0.000001, RMSE = 0.000716
2025-12-10 21:12:08,353 - root - INFO - Epoch 12: Val Loss = 0.000001, RMSE = 0.000641
2025-12-10 21:12:08,357 - root - INFO - Epoch 12: Train Loss = 0.000001, RMSE = 0.000698
2025-12-10 21:12:55,037 - root - INFO - Epoch 13: Val Loss = 0.000001, RMSE = 0.000665
2025-12-10 21:12:55,040 - root - INFO - Epoch 13: Train Loss = 0.000001, RMSE = 0.000674
2025-12-10 21:13:41,284 - root - INFO - Epoch 14: Val Loss = 0.000000, RMSE = 0.000584
2025-12-10 21:13:41,288 - root - INFO - Epoch 14: Train Loss = 0.000001, RMSE = 0.000665
2025-12-10 21:14:29,729 - root - INFO - Epoch 15: Val Loss = 0.000000, RMSE = 0.000433
2025-12-10 21:14:29,733 - root - INFO - Epoch 15: Train Loss = 0.000001, RMSE = 0.000660
2025-12-10 21:15:17,781 - root - INFO - Epoch 16: Val Loss = 0.000001, RMSE = 0.000704
2025-12-10 21:15:17,785 - root - INFO - Epoch 16: Train Loss = 0.000001, RMSE = 0.000633
2025-12-10 21:16:03,536 - root - INFO - Epoch 17: Val Loss = 0.000000, RMSE = 0.000598
2025-12-10 21:16:03,539 - root - INFO - Epoch 17: Train Loss = 0.000001, RMSE = 0.000649
2025-12-10 21:16:50,487 - root - INFO - Epoch 18: Val Loss = 0.000000, RMSE = 0.000465
2025-12-10 21:16:50,490 - root - INFO - Epoch 18: Train Loss = 0.000001, RMSE = 0.000635
2025-12-10 21:17:34,464 - root - INFO - Epoch 19: Val Loss = 0.000000, RMSE = 0.000504
2025-12-10 21:17:34,467 - root - INFO - Epoch 19: Train Loss = 0.000001, RMSE = 0.000614
2025-12-10 21:18:20,690 - root - INFO - Epoch 20: Val Loss = 0.000000, RMSE = 0.000500
2025-12-10 21:18:20,694 - root - INFO - Epoch 20: Train Loss = 0.000000, RMSE = 0.000605
2025-12-10 21:19:06,451 - root - INFO - Epoch 21: Val Loss = 0.000000, RMSE = 0.000436
2025-12-10 21:19:06,455 - root - INFO - Epoch 21: Train Loss = 0.000000, RMSE = 0.000597
2025-12-10 21:19:51,445 - root - INFO - Epoch 22: Val Loss = 0.000000, RMSE = 0.000425
2025-12-10 21:19:51,449 - root - INFO - Epoch 22: Train Loss = 0.000000, RMSE = 0.000602
2025-12-10 21:20:37,795 - root - INFO - Epoch 23: Val Loss = 0.000000, RMSE = 0.000437
2025-12-10 21:20:37,799 - root - INFO - Epoch 23: Train Loss = 0.000000, RMSE = 0.000588
2025-12-10 21:21:24,827 - root - INFO - Epoch 24: Val Loss = 0.000000, RMSE = 0.000415
2025-12-10 21:21:24,831 - root - INFO - Epoch 24: Train Loss = 0.000000, RMSE = 0.000591
2025-12-10 21:22:11,317 - root - INFO - Epoch 25: Val Loss = 0.000000, RMSE = 0.000576
2025-12-10 21:22:11,321 - root - INFO - Epoch 25: Train Loss = 0.000000, RMSE = 0.000576
2025-12-10 21:22:57,815 - root - INFO - Epoch 26: Val Loss = 0.000000, RMSE = 0.000487
2025-12-10 21:22:57,819 - root - INFO - Epoch 26: Train Loss = 0.000000, RMSE = 0.000570
2025-12-10 21:23:45,295 - root - INFO - Epoch 27: Val Loss = 0.000000, RMSE = 0.000428
2025-12-10 21:23:45,298 - root - INFO - Epoch 27: Train Loss = 0.000000, RMSE = 0.000549
2025-12-10 21:24:31,656 - root - INFO - Epoch 28: Val Loss = 0.000000, RMSE = 0.000417
2025-12-10 21:24:31,660 - root - INFO - Epoch 28: Train Loss = 0.000000, RMSE = 0.000573
2025-12-10 21:25:17,549 - root - INFO - Epoch 29: Val Loss = 0.000000, RMSE = 0.000548
2025-12-10 21:25:17,553 - root - INFO - Epoch 29: Train Loss = 0.000000, RMSE = 0.000568
2025-12-10 21:26:03,224 - root - INFO - Epoch 30: Val Loss = 0.000000, RMSE = 0.000484
2025-12-10 21:26:03,228 - root - INFO - Epoch 30: Train Loss = 0.000000, RMSE = 0.000528
2025-12-10 21:26:51,128 - root - INFO - Epoch 31: Val Loss = 0.000000, RMSE = 0.000439
2025-12-10 21:26:51,132 - root - INFO - Epoch 31: Train Loss = 0.000000, RMSE = 0.000547
2025-12-10 21:27:37,744 - root - INFO - Epoch 32: Val Loss = 0.000000, RMSE = 0.000392
2025-12-10 21:27:37,748 - root - INFO - Epoch 32: Train Loss = 0.000000, RMSE = 0.000546
2025-12-10 21:28:25,019 - root - INFO - Epoch 33: Val Loss = 0.000003, RMSE = 0.001622
2025-12-10 21:28:25,023 - root - INFO - Epoch 33: Train Loss = 0.000000, RMSE = 0.000530
2025-12-10 21:29:12,374 - root - INFO - Epoch 34: Val Loss = 0.000000, RMSE = 0.000673
2025-12-10 21:29:12,378 - root - INFO - Epoch 34: Train Loss = 0.000000, RMSE = 0.000530
2025-12-10 21:29:58,939 - root - INFO - Epoch 35: Val Loss = 0.000000, RMSE = 0.000518
2025-12-10 21:29:58,943 - root - INFO - Epoch 35: Train Loss = 0.000000, RMSE = 0.000528
2025-12-10 21:30:44,740 - root - INFO - Epoch 36: Val Loss = 0.000000, RMSE = 0.000621
2025-12-10 21:30:44,744 - root - INFO - Epoch 36: Train Loss = 0.000000, RMSE = 0.000535
2025-12-10 21:31:31,990 - root - INFO - Epoch 37: Val Loss = 0.000000, RMSE = 0.000516
2025-12-10 21:31:31,994 - root - INFO - Epoch 37: Train Loss = 0.000000, RMSE = 0.000519
2025-12-10 21:32:19,047 - root - INFO - Epoch 38: Val Loss = 0.000000, RMSE = 0.000398
2025-12-10 21:32:19,051 - root - INFO - Epoch 38: Train Loss = 0.000000, RMSE = 0.000532
2025-12-10 21:33:05,221 - root - INFO - Epoch 39: Val Loss = 0.000000, RMSE = 0.000432
2025-12-10 21:33:05,225 - root - INFO - Epoch 39: Train Loss = 0.000000, RMSE = 0.000505
2025-12-10 21:33:52,537 - root - INFO - Epoch 40: Val Loss = 0.000000, RMSE = 0.000369
2025-12-10 21:33:52,542 - root - INFO - Epoch 40: Train Loss = 0.000000, RMSE = 0.000506
2025-12-10 21:34:39,082 - root - INFO - Epoch 41: Val Loss = 0.000000, RMSE = 0.000415
2025-12-10 21:34:39,086 - root - INFO - Epoch 41: Train Loss = 0.000000, RMSE = 0.000520
2025-12-10 21:35:26,100 - root - INFO - Epoch 42: Val Loss = 0.000000, RMSE = 0.000407
2025-12-10 21:35:26,104 - root - INFO - Epoch 42: Train Loss = 0.000000, RMSE = 0.000496
2025-12-10 21:36:13,018 - root - INFO - Epoch 43: Val Loss = 0.000000, RMSE = 0.000384
2025-12-10 21:36:13,022 - root - INFO - Epoch 43: Train Loss = 0.000000, RMSE = 0.000502
2025-12-10 21:36:59,388 - root - INFO - Epoch 44: Val Loss = 0.000000, RMSE = 0.000439
2025-12-10 21:36:59,392 - root - INFO - Epoch 44: Train Loss = 0.000000, RMSE = 0.000505
2025-12-10 21:37:47,497 - root - INFO - Epoch 45: Val Loss = 0.000000, RMSE = 0.000382
2025-12-10 21:37:47,501 - root - INFO - Epoch 45: Train Loss = 0.000000, RMSE = 0.000491
2025-12-10 21:38:33,841 - root - INFO - Epoch 46: Val Loss = 0.000000, RMSE = 0.000418
2025-12-10 21:38:33,845 - root - INFO - Epoch 46: Train Loss = 0.000000, RMSE = 0.000494
2025-12-10 21:39:20,672 - root - INFO - Epoch 47: Val Loss = 0.000000, RMSE = 0.000439
2025-12-10 21:39:20,675 - root - INFO - Epoch 47: Train Loss = 0.000000, RMSE = 0.000490
2025-12-10 21:40:08,603 - root - INFO - Epoch 48: Val Loss = 0.000000, RMSE = 0.000468
2025-12-10 21:40:08,607 - root - INFO - Epoch 48: Train Loss = 0.000000, RMSE = 0.000478
2025-12-10 21:40:55,014 - root - INFO - Epoch 49: Val Loss = 0.000000, RMSE = 0.000369
2025-12-10 21:40:55,018 - root - INFO - Epoch 49: Train Loss = 0.000000, RMSE = 0.000484
2025-12-10 21:41:40,390 - root - INFO - Epoch 50: Val Loss = 0.000000, RMSE = 0.000452
2025-12-10 21:41:40,394 - root - INFO - Epoch 50: Train Loss = 0.000000, RMSE = 0.000482
2025-12-10 21:42:27,456 - root - INFO - Epoch 51: Val Loss = 0.000000, RMSE = 0.000390
2025-12-10 21:42:27,460 - root - INFO - Epoch 51: Train Loss = 0.000000, RMSE = 0.000484
2025-12-10 21:43:15,006 - root - INFO - Epoch 52: Val Loss = 0.000000, RMSE = 0.000544
2025-12-10 21:43:15,010 - root - INFO - Epoch 52: Train Loss = 0.000000, RMSE = 0.000477
2025-12-10 21:44:02,005 - root - INFO - Epoch 53: Val Loss = 0.000000, RMSE = 0.000510
2025-12-10 21:44:02,008 - root - INFO - Epoch 53: Train Loss = 0.000000, RMSE = 0.000469
2025-12-10 21:44:49,121 - root - INFO - Epoch 54: Val Loss = 0.000000, RMSE = 0.000372
2025-12-10 21:44:49,125 - root - INFO - Epoch 54: Train Loss = 0.000000, RMSE = 0.000452
2025-12-10 21:45:35,849 - root - INFO - Epoch 55: Val Loss = 0.000000, RMSE = 0.000518
2025-12-10 21:45:35,853 - root - INFO - Epoch 55: Train Loss = 0.000000, RMSE = 0.000465
2025-12-10 21:46:23,228 - root - INFO - Epoch 56: Val Loss = 0.000000, RMSE = 0.000362
2025-12-10 21:46:23,232 - root - INFO - Epoch 56: Train Loss = 0.000000, RMSE = 0.000462
2025-12-10 21:47:10,046 - root - INFO - Epoch 57: Val Loss = 0.000000, RMSE = 0.000610
2025-12-10 21:47:10,049 - root - INFO - Epoch 57: Train Loss = 0.000000, RMSE = 0.000470
2025-12-10 21:47:57,390 - root - INFO - Epoch 58: Val Loss = 0.000000, RMSE = 0.000490
2025-12-10 21:47:57,394 - root - INFO - Epoch 58: Train Loss = 0.000000, RMSE = 0.000458
2025-12-10 21:48:43,881 - root - INFO - Epoch 59: Val Loss = 0.000000, RMSE = 0.000373
2025-12-10 21:48:43,885 - root - INFO - Epoch 59: Train Loss = 0.000000, RMSE = 0.000449
2025-12-10 21:49:31,072 - root - INFO - Epoch 60: Val Loss = 0.000000, RMSE = 0.000357
2025-12-10 21:49:31,076 - root - INFO - Epoch 60: Train Loss = 0.000000, RMSE = 0.000459
2025-12-10 21:50:17,910 - root - INFO - Epoch 61: Val Loss = 0.000000, RMSE = 0.000502
2025-12-10 21:50:17,914 - root - INFO - Epoch 61: Train Loss = 0.000000, RMSE = 0.000454
2025-12-10 21:51:03,732 - root - INFO - Epoch 62: Val Loss = 0.000000, RMSE = 0.000339
2025-12-10 21:51:03,736 - root - INFO - Epoch 62: Train Loss = 0.000000, RMSE = 0.000441
2025-12-10 21:51:51,472 - root - INFO - Epoch 63: Val Loss = 0.000000, RMSE = 0.000682
2025-12-10 21:51:51,476 - root - INFO - Epoch 63: Train Loss = 0.000000, RMSE = 0.000451
2025-12-10 21:52:38,544 - root - INFO - Epoch 64: Val Loss = 0.000000, RMSE = 0.000599
2025-12-10 21:52:38,548 - root - INFO - Epoch 64: Train Loss = 0.000000, RMSE = 0.000461
2025-12-10 21:53:23,996 - root - INFO - Epoch 65: Val Loss = 0.000000, RMSE = 0.000388
2025-12-10 21:53:24,000 - root - INFO - Epoch 65: Train Loss = 0.000000, RMSE = 0.000435
2025-12-10 21:54:10,490 - root - INFO - Epoch 66: Val Loss = 0.000000, RMSE = 0.000333
2025-12-10 21:54:10,494 - root - INFO - Epoch 66: Train Loss = 0.000000, RMSE = 0.000448
2025-12-10 21:54:57,993 - root - INFO - Epoch 67: Val Loss = 0.000000, RMSE = 0.000324
2025-12-10 21:54:57,997 - root - INFO - Epoch 67: Train Loss = 0.000000, RMSE = 0.000435
2025-12-10 21:55:44,448 - root - INFO - Epoch 68: Val Loss = 0.000000, RMSE = 0.000642
2025-12-10 21:55:44,452 - root - INFO - Epoch 68: Train Loss = 0.000000, RMSE = 0.000419
2025-12-10 21:56:31,276 - root - INFO - Epoch 69: Val Loss = 0.000000, RMSE = 0.000338
2025-12-10 21:56:31,280 - root - INFO - Epoch 69: Train Loss = 0.000000, RMSE = 0.000445
2025-12-10 21:57:17,145 - root - INFO - Epoch 70: Val Loss = 0.000000, RMSE = 0.000324
2025-12-10 21:57:17,149 - root - INFO - Epoch 70: Train Loss = 0.000000, RMSE = 0.000426
2025-12-10 21:58:04,943 - root - INFO - Epoch 71: Val Loss = 0.000000, RMSE = 0.000345
2025-12-10 21:58:04,947 - root - INFO - Epoch 71: Train Loss = 0.000000, RMSE = 0.000430
2025-12-10 21:58:50,667 - root - INFO - Epoch 72: Val Loss = 0.000000, RMSE = 0.000397
2025-12-10 21:58:50,670 - root - INFO - Epoch 72: Train Loss = 0.000000, RMSE = 0.000435
2025-12-10 21:59:37,581 - root - INFO - Epoch 73: Val Loss = 0.000000, RMSE = 0.000356
2025-12-10 21:59:37,585 - root - INFO - Epoch 73: Train Loss = 0.000000, RMSE = 0.000429
2025-12-10 22:00:24,803 - root - INFO - Epoch 74: Val Loss = 0.000000, RMSE = 0.000329
2025-12-10 22:00:24,807 - root - INFO - Epoch 74: Train Loss = 0.000000, RMSE = 0.000427
2025-12-10 22:01:11,340 - root - INFO - Epoch 75: Val Loss = 0.000000, RMSE = 0.000451
2025-12-10 22:01:11,344 - root - INFO - Epoch 75: Train Loss = 0.000000, RMSE = 0.000419
2025-12-10 22:01:58,528 - root - INFO - Epoch 76: Val Loss = 0.000000, RMSE = 0.000335
2025-12-10 22:01:58,532 - root - INFO - Epoch 76: Train Loss = 0.000000, RMSE = 0.000424
2025-12-10 22:02:44,355 - root - INFO - Epoch 77: Val Loss = 0.000000, RMSE = 0.000611
2025-12-10 22:02:44,359 - root - INFO - Epoch 77: Train Loss = 0.000000, RMSE = 0.000429
2025-12-10 22:03:31,503 - root - INFO - Epoch 78: Val Loss = 0.000000, RMSE = 0.000327
2025-12-10 22:03:31,506 - root - INFO - Epoch 78: Train Loss = 0.000000, RMSE = 0.000430
2025-12-10 22:04:17,670 - root - INFO - Epoch 79: Val Loss = 0.000001, RMSE = 0.000691
2025-12-10 22:04:17,674 - root - INFO - Epoch 79: Train Loss = 0.000000, RMSE = 0.000414
2025-12-10 22:05:04,520 - root - INFO - Epoch 80: Val Loss = 0.000000, RMSE = 0.000584
2025-12-10 22:05:04,524 - root - INFO - Epoch 80: Train Loss = 0.000000, RMSE = 0.000414
2025-12-10 22:05:04,720 - __main__ - INFO - 
Training completed!
2025-12-10 22:05:04,720 - __main__ - INFO - Best model checkpoint: /home/cnagda/DataAssimilation/deterministic_runs/lorenz96_10dim_resnet1d_stable/checkpoints/det-epoch=070-val_loss=0.000000.ckpt
2025-12-10 22:05:04,721 - __main__ - INFO - Best validation loss: 0.000000
2025-12-10 22:05:04,753 - __main__ - INFO - Final model saved to: deterministic_runs/lorenz96_10dim_resnet1d_stable/final_model.ckpt
2025-12-10 22:05:04,769 - eval_deterministic - INFO - Running Deterministic Model Evaluation (Autoregressive)
2025-12-10 22:05:04,769 - eval_deterministic - INFO - Checkpoint: /home/cnagda/DataAssimilation/deterministic_runs/lorenz96_10dim_resnet1d_stable/checkpoints/det-epoch=070-val_loss=0.000000.ckpt
2025-12-10 22:05:04,829 - root - INFO - Updated system normalization stats from data.h5
2025-12-10 22:05:04,835 - eval_deterministic - INFO - Evaluating on 411 trajectories, length 99
2025-12-10 22:05:22,431 - eval_deterministic - INFO - Global Mean RMSE (Autoregressive): 0.0453
