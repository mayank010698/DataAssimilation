2025-12-09 18:18:36,687 - __main__ - INFO - ================================================================================
2025-12-09 18:18:36,687 - __main__ - INFO - Training Deterministic Next-Step Prediction Model
2025-12-09 18:18:36,687 - __main__ - INFO - ================================================================================
2025-12-09 18:18:36,687 - __main__ - INFO - Data directory: datasets/lorenz96_n4096_len100_dt0p0100_obs0p100_freq1_comp10of10_arctan
2025-12-09 18:18:36,687 - __main__ - INFO - Output directory: deterministic_runs/lorenz96_10dim_resnet1d_adaln
2025-12-09 18:18:36,687 - __main__ - INFO - State dimension: 10
2025-12-09 18:18:36,687 - __main__ - INFO - Observation dimension: 10
2025-12-09 18:18:36,687 - __main__ - INFO - Use observations: True
2025-12-09 18:18:36,687 - __main__ - INFO - Architecture: ResNet1D (Deterministic)
2025-12-09 18:18:36,687 - __main__ - INFO -   Channels: 64
2025-12-09 18:18:36,687 - __main__ - INFO -   Num blocks: 10
2025-12-09 18:18:36,687 - __main__ - INFO -   Kernel size: 5
2025-12-09 18:18:36,687 - __main__ - INFO - Conditioning method: concat
2025-12-09 18:18:36,687 - __main__ - INFO - Batch size: 1024
2025-12-09 18:18:36,687 - __main__ - INFO - Learning rate: 0.004
2025-12-09 18:18:36,687 - __main__ - INFO - Max epochs: 500
2025-12-09 18:18:36,687 - __main__ - INFO - GPUs: 1
2025-12-09 18:18:36,699 - __main__ - INFO - 
Model architecture:
2025-12-09 18:18:36,699 - __main__ - INFO -   Total parameters: 411,713
2025-12-09 18:18:36,699 - __main__ - INFO -   Trainable parameters: 411,713
2025-12-09 18:18:39,081 - __main__ - INFO - 
Starting training...
2025-12-09 18:18:39,563 - root - INFO - Loaded RF training data: 324324 pairs
2025-12-09 18:18:39,564 - root - INFO - Loaded RF validation data: 40491 pairs
2025-12-09 18:18:40,041 - root - INFO - Epoch 0: Val Loss = 1.036995, RMSE = 1.018321
2025-12-09 18:18:51,328 - root - INFO - Epoch 0: Val Loss = 0.000306, RMSE = 0.017394
2025-12-09 18:18:51,331 - root - INFO - Epoch 0: Train Loss = 0.069699, RMSE = 0.086655
2025-12-09 18:19:02,274 - root - INFO - Epoch 1: Val Loss = 0.002657, RMSE = 0.051519
2025-12-09 18:19:02,277 - root - INFO - Epoch 1: Train Loss = 0.000350, RMSE = 0.015960
2025-12-09 18:19:13,192 - root - INFO - Epoch 2: Val Loss = 0.000469, RMSE = 0.021623
2025-12-09 18:19:13,195 - root - INFO - Epoch 2: Train Loss = 0.000388, RMSE = 0.016966
2025-12-09 18:19:25,176 - root - INFO - Epoch 3: Val Loss = 0.000226, RMSE = 0.015031
2025-12-09 18:19:25,179 - root - INFO - Epoch 3: Train Loss = 0.000279, RMSE = 0.014783
2025-12-09 18:19:35,923 - root - INFO - Epoch 4: Val Loss = 0.000038, RMSE = 0.006127
2025-12-09 18:19:35,926 - root - INFO - Epoch 4: Train Loss = 0.000374, RMSE = 0.015900
2025-12-09 18:19:47,763 - root - INFO - Epoch 5: Val Loss = 0.000543, RMSE = 0.023291
2025-12-09 18:19:47,766 - root - INFO - Epoch 5: Train Loss = 0.000190, RMSE = 0.011761
2025-12-09 18:19:58,670 - root - INFO - Epoch 6: Val Loss = 0.000028, RMSE = 0.005280
2025-12-09 18:19:58,674 - root - INFO - Epoch 6: Train Loss = 0.000244, RMSE = 0.011166
2025-12-09 18:20:10,612 - root - INFO - Epoch 7: Val Loss = 0.000291, RMSE = 0.017055
2025-12-09 18:20:10,616 - root - INFO - Epoch 7: Train Loss = 0.000183, RMSE = 0.011826
2025-12-09 18:20:21,018 - root - INFO - Epoch 8: Val Loss = 0.000082, RMSE = 0.009023
2025-12-09 18:20:21,022 - root - INFO - Epoch 8: Train Loss = 0.000206, RMSE = 0.011896
2025-12-09 18:20:33,039 - root - INFO - Epoch 9: Val Loss = 0.000016, RMSE = 0.004036
2025-12-09 18:20:33,043 - root - INFO - Epoch 9: Train Loss = 0.000188, RMSE = 0.011075
2025-12-09 18:20:43,789 - root - INFO - Epoch 10: Val Loss = 0.000341, RMSE = 0.018413
2025-12-09 18:20:43,793 - root - INFO - Epoch 10: Train Loss = 0.000150, RMSE = 0.010948
2025-12-09 18:20:55,252 - root - INFO - Epoch 11: Val Loss = 0.000040, RMSE = 0.006308
2025-12-09 18:20:55,255 - root - INFO - Epoch 11: Train Loss = 0.000244, RMSE = 0.012549
2025-12-09 18:21:07,376 - root - INFO - Epoch 12: Val Loss = 0.000015, RMSE = 0.003850
2025-12-09 18:21:07,380 - root - INFO - Epoch 12: Train Loss = 0.000077, RMSE = 0.007235
2025-12-09 18:21:18,671 - root - INFO - Epoch 13: Val Loss = 0.000029, RMSE = 0.005348
2025-12-09 18:21:18,674 - root - INFO - Epoch 13: Train Loss = 0.000159, RMSE = 0.010772
2025-12-09 18:21:30,698 - root - INFO - Epoch 14: Val Loss = 0.000024, RMSE = 0.004879
2025-12-09 18:21:30,701 - root - INFO - Epoch 14: Train Loss = 0.000078, RMSE = 0.007399
2025-12-09 18:21:41,905 - root - INFO - Epoch 15: Val Loss = 0.000015, RMSE = 0.003866
2025-12-09 18:21:41,908 - root - INFO - Epoch 15: Train Loss = 0.000144, RMSE = 0.009292
2025-12-09 18:21:53,242 - root - INFO - Epoch 16: Val Loss = 0.000116, RMSE = 0.010765
2025-12-09 18:21:53,245 - root - INFO - Epoch 16: Train Loss = 0.000111, RMSE = 0.008440
2025-12-09 18:22:04,216 - root - INFO - Epoch 17: Val Loss = 380691820192343654710378496.000000, RMSE = 19433789639884.800781
2025-12-09 18:22:04,219 - root - INFO - Epoch 17: Train Loss = 98774432807542357191819264.000000, RMSE = 5398572949233.041992
2025-12-09 18:22:15,183 - root - INFO - Epoch 18: Val Loss = 379442522289817920397639680.000000, RMSE = 19401669109350.398438
2025-12-09 18:22:15,186 - root - INFO - Epoch 18: Train Loss = 384077571723536255946850304.000000, RMSE = 19592989006864.152344
2025-12-09 18:22:27,288 - root - INFO - Epoch 19: Val Loss = 380154777365114096246063104.000000, RMSE = 19420094791680.000000
2025-12-09 18:22:27,292 - root - INFO - Epoch 19: Train Loss = 383730105127900070094569472.000000, RMSE = 19584868695392.101562
2025-12-09 18:22:39,508 - root - INFO - Epoch 20: Val Loss = 379916717059988281700122624.000000, RMSE = 19413956794777.601562
2025-12-09 18:22:39,511 - root - INFO - Epoch 20: Train Loss = 384035174704576488366145536.000000, RMSE = 19592843549195.304688
2025-12-09 18:22:51,552 - root - INFO - Epoch 21: Val Loss = 378328032731814212413685760.000000, RMSE = 19373271076044.800781
2025-12-09 18:22:51,555 - root - INFO - Epoch 21: Train Loss = 383130129606807246291861504.000000, RMSE = 19570423935815.875000
2025-12-09 18:23:03,062 - root - INFO - Epoch 22: Val Loss = 378634322931582660163665920.000000, RMSE = 19381219518054.398438
2025-12-09 18:23:03,066 - root - INFO - Epoch 22: Train Loss = 382509938549108041710567424.000000, RMSE = 19553175621412.339844
2025-12-09 18:23:15,097 - root - INFO - Epoch 23: Val Loss = 377714244992877637647990784.000000, RMSE = 19357551611084.800781
2025-12-09 18:23:15,100 - root - INFO - Epoch 23: Train Loss = 382218530735837546721312768.000000, RMSE = 19546303955564.214844
2025-12-09 18:23:26,512 - root - INFO - Epoch 24: Val Loss = 377953852979831277656997888.000000, RMSE = 19363718155468.800781
2025-12-09 18:23:26,516 - root - INFO - Epoch 24: Train Loss = 382352209576618377558884352.000000, RMSE = 19549556016447.796875
2025-12-09 18:23:38,089 - root - INFO - Epoch 25: Val Loss = 376573994556774994275205120.000000, RMSE = 19328400936140.800781
2025-12-09 18:23:38,092 - root - INFO - Epoch 25: Train Loss = 381282070309186176058130432.000000, RMSE = 19522203802330.042969
2025-12-09 18:23:48,688 - root - INFO - Epoch 26: Val Loss = 377999640104465233977802752.000000, RMSE = 19364958332518.398438
2025-12-09 18:23:48,692 - root - INFO - Epoch 26: Train Loss = 381624051878945740042534912.000000, RMSE = 19531742787512.933594
2025-12-09 18:23:59,717 - root - INFO - Epoch 27: Val Loss = 376258385061900522203643904.000000, RMSE = 19320283096678.398438
2025-12-09 18:23:59,720 - root - INFO - Epoch 27: Train Loss = 380992222264143285520957440.000000, RMSE = 19515167678748.265625
2025-12-09 18:24:11,716 - root - INFO - Epoch 28: Val Loss = 373355321334602810802569216.000000, RMSE = 19245533338009.601562
2025-12-09 18:24:11,720 - root - INFO - Epoch 28: Train Loss = 378527327470495800915656704.000000, RMSE = 19451432080432.453125
2025-12-09 18:24:22,956 - root - INFO - Epoch 29: Val Loss = 373160662528933633833566208.000000, RMSE = 19240406325657.601562
2025-12-09 18:24:22,959 - root - INFO - Epoch 29: Train Loss = 377674614447256412052520960.000000, RMSE = 19429310950661.652344
2025-12-09 18:24:34,773 - root - INFO - Epoch 30: Val Loss = 374558877768186198713434112.000000, RMSE = 19276707738419.199219
2025-12-09 18:24:34,776 - root - INFO - Epoch 30: Train Loss = 377163290486684586497540096.000000, RMSE = 19416006691145.488281
2025-12-09 18:24:47,193 - root - INFO - Epoch 31: Val Loss = 374226517707355580939632640.000000, RMSE = 19267967909888.000000
2025-12-09 18:24:47,196 - root - INFO - Epoch 31: Train Loss = 378714587410774247908311040.000000, RMSE = 19456790396411.156250
2025-12-09 18:24:59,449 - root - INFO - Epoch 32: Val Loss = 372605693616981873757519872.000000, RMSE = 19226185826304.000000
2025-12-09 18:24:59,452 - root - INFO - Epoch 32: Train Loss = 376597468326657334095904768.000000, RMSE = 19402034564796.972656
2025-12-09 18:25:10,622 - root - INFO - Epoch 33: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:25:10,625 - root - INFO - Epoch 33: Train Loss = 376383949417094135106502656.000000, RMSE = 19395833259870.484375
2025-12-09 18:25:22,663 - root - INFO - Epoch 34: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:25:22,667 - root - INFO - Epoch 34: Train Loss = 376417211049749091218096128.000000, RMSE = 19397441259436.011719
2025-12-09 18:25:34,660 - root - INFO - Epoch 35: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:25:34,664 - root - INFO - Epoch 35: Train Loss = 376434376297930036908916736.000000, RMSE = 19397782698274.726562
2025-12-09 18:25:45,710 - root - INFO - Epoch 36: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:25:45,714 - root - INFO - Epoch 36: Train Loss = 376430154961309874775916544.000000, RMSE = 19398653843307.406250
2025-12-09 18:25:57,024 - root - INFO - Epoch 37: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:25:57,027 - root - INFO - Epoch 37: Train Loss = 376405182376014050184134656.000000, RMSE = 19397235123287.218750
2025-12-09 18:26:09,153 - root - INFO - Epoch 38: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:26:09,156 - root - INFO - Epoch 38: Train Loss = 376413055586044621405290496.000000, RMSE = 19397483354635.304688
2025-12-09 18:26:21,297 - root - INFO - Epoch 39: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:26:21,301 - root - INFO - Epoch 39: Train Loss = 376407247596667646089625600.000000, RMSE = 19396939094074.144531
2025-12-09 18:26:32,186 - root - INFO - Epoch 40: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:26:32,190 - root - INFO - Epoch 40: Train Loss = 376430973833810229311045632.000000, RMSE = 19397609468227.027344
2025-12-09 18:26:44,177 - root - INFO - Epoch 41: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:26:44,180 - root - INFO - Epoch 41: Train Loss = 376399536857644835497050112.000000, RMSE = 19396507610011.859375
2025-12-09 18:26:56,280 - root - INFO - Epoch 42: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:26:56,283 - root - INFO - Epoch 42: Train Loss = 376405734032587636542013440.000000, RMSE = 19397264946508.718750
2025-12-09 18:27:08,186 - root - INFO - Epoch 43: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:27:08,190 - root - INFO - Epoch 43: Train Loss = 376399683966064408131534848.000000, RMSE = 19396092459918.941406
2025-12-09 18:27:20,455 - root - INFO - Epoch 44: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:27:20,458 - root - INFO - Epoch 44: Train Loss = 376427311136758221970079744.000000, RMSE = 19397986188174.941406
2025-12-09 18:27:32,043 - root - INFO - Epoch 45: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:27:32,046 - root - INFO - Epoch 45: Train Loss = 376422621124816978722160640.000000, RMSE = 19397228051187.886719
2025-12-09 18:27:43,606 - root - INFO - Epoch 46: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:27:43,609 - root - INFO - Epoch 46: Train Loss = 376419611570526720872153088.000000, RMSE = 19397481680883.078125
2025-12-09 18:27:55,255 - root - INFO - Epoch 47: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:27:55,258 - root - INFO - Epoch 47: Train Loss = 376438847742140223015878656.000000, RMSE = 19397975186396.468750
2025-12-09 18:28:07,352 - root - INFO - Epoch 48: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:28:07,355 - root - INFO - Epoch 48: Train Loss = 376436514840026910610685952.000000, RMSE = 19397687506097.664062
2025-12-09 18:28:18,661 - root - INFO - Epoch 49: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:28:18,664 - root - INFO - Epoch 49: Train Loss = 376446663807998295279665152.000000, RMSE = 19398661325575.269531
2025-12-09 18:28:30,722 - root - INFO - Epoch 50: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:28:30,726 - root - INFO - Epoch 50: Train Loss = 376395678171211001604603904.000000, RMSE = 19396848605603.937500
2025-12-09 18:28:42,482 - root - INFO - Epoch 51: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:28:42,485 - root - INFO - Epoch 51: Train Loss = 376446418006588318166286336.000000, RMSE = 19398292021739.003906
2025-12-09 18:28:54,627 - root - INFO - Epoch 52: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:28:54,631 - root - INFO - Epoch 52: Train Loss = 376418415267168172944392192.000000, RMSE = 19397278488685.828125
2025-12-09 18:29:06,833 - root - INFO - Epoch 53: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:29:06,836 - root - INFO - Epoch 53: Train Loss = 376431739402785045987983360.000000, RMSE = 19398000120673.714844
2025-12-09 18:29:18,571 - root - INFO - Epoch 54: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:29:18,574 - root - INFO - Epoch 54: Train Loss = 376419310487076175530164224.000000, RMSE = 19397240177622.007812
2025-12-09 18:29:30,193 - root - INFO - Epoch 55: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:29:30,196 - root - INFO - Epoch 55: Train Loss = 376448556199535411906740224.000000, RMSE = 19398916337935.343750
2025-12-09 18:29:41,383 - root - INFO - Epoch 56: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:29:41,386 - root - INFO - Epoch 56: Train Loss = 376446617487467394575106048.000000, RMSE = 19398400319462.156250
2025-12-09 18:29:52,965 - root - INFO - Epoch 57: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:29:52,968 - root - INFO - Epoch 57: Train Loss = 376433036494032403284623360.000000, RMSE = 19397677318040.632812
2025-12-09 18:30:05,057 - root - INFO - Epoch 58: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:30:05,061 - root - INFO - Epoch 58: Train Loss = 376408704249341630841094144.000000, RMSE = 19397039750754.523438
2025-12-09 18:30:15,673 - root - INFO - Epoch 59: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:30:15,676 - root - INFO - Epoch 59: Train Loss = 376401069159426977096007680.000000, RMSE = 19397160571849.085938
2025-12-09 18:30:27,134 - root - INFO - Epoch 60: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:30:27,137 - root - INFO - Epoch 60: Train Loss = 376409198412592938280288256.000000, RMSE = 19396864880032.707031
2025-12-09 18:30:38,987 - root - INFO - Epoch 61: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:30:38,990 - root - INFO - Epoch 61: Train Loss = 376434328464417054156390400.000000, RMSE = 19397974756381.074219
2025-12-09 18:30:50,650 - root - INFO - Epoch 62: Val Loss = 372504860024526176350371840.000000, RMSE = 19223416170086.398438
2025-12-09 18:30:50,653 - root - INFO - Epoch 62: Train Loss = 376392116494814209074266112.000000, RMSE = 19397283516558.132812
2025-12-09 18:30:50,856 - __main__ - INFO - 
Training completed!
2025-12-09 18:30:50,856 - __main__ - INFO - Best model checkpoint: /home/cnagda/DataAssimilation/deterministic_runs/lorenz96_10dim_resnet1d_adaln/checkpoints/det-epoch=012-val_loss=0.000015.ckpt
2025-12-09 18:30:50,857 - __main__ - INFO - Best validation loss: 0.000015
2025-12-09 18:30:50,890 - __main__ - INFO - Final model saved to: deterministic_runs/lorenz96_10dim_resnet1d_adaln/final_model.ckpt
2025-12-09 18:30:50,900 - eval_deterministic - INFO - Running Deterministic Model Evaluation (Autoregressive)
2025-12-09 18:30:50,901 - eval_deterministic - INFO - Checkpoint: /home/cnagda/DataAssimilation/deterministic_runs/lorenz96_10dim_resnet1d_adaln/checkpoints/det-epoch=012-val_loss=0.000015.ckpt
2025-12-09 18:30:50,961 - root - INFO - Updated system normalization stats from data.h5
2025-12-09 18:30:50,968 - eval_deterministic - INFO - Evaluating on 411 trajectories, length 99
2025-12-09 18:31:05,472 - eval_deterministic - INFO - Global Mean RMSE (Autoregressive): 3.3994
